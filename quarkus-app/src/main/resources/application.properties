# OIDC Configuration (Multi-Tenant)
quarkus.oidc.tenant-enabled=true

# Google (Default Tenant)
quarkus.oidc.provider=google
quarkus.oidc.application-type=web-app
quarkus.oidc.authentication.redirect-path=${OIDC_REDIRECT_PATH:/login/callback}
quarkus.oidc.authentication.force-redirect-https=true
quarkus.http.auth.form.enabled=false
quarkus.oidc.client-id=${OIDC_CLIENT_ID:dev-client}
quarkus.oidc.credentials.secret=${OIDC_CLIENT_SECRET:dev-secret}
quarkus.oidc.authentication.scopes=openid profile email
quarkus.oidc.logout.post-logout-path=/
quarkus.oidc.authentication.user-info-required=false
quarkus.oidc.authentication.id-token-required=true
quarkus.oidc.token.principal-claim=id_token
# Disable Quarkus built-in logout as Google does not provide an end_session_endpoint
quarkus.oidc.logout.path=

# GitHub Tenant (Disabled - Using Manual Auth)
# quarkus.oidc.github.provider=github
# quarkus.oidc.github.application-type=web-app
# quarkus.oidc.github.client-id=${GH_CLIENT_ID}
# quarkus.oidc.github.credentials.secret=${GH_CLIENT_SECRET}
# quarkus.oidc.github.authentication.redirect-path=/auth/github/oidc-callback-unused
# quarkus.oidc.github.authentication.scopes=read:user user:email
# quarkus.oidc.github.authentication.user-info-required=true
# quarkus.oidc.github.token.principal-claim=login
# quarkus.oidc.github.authentication.force-redirect-https=true
# %prod.quarkus.oidc.github.authentication.redirect-path=https://homedir.opensourcesantiago.io/auth/github/callback

# Comunidad members live in os-santiago/os-santiago.github.io
community.github.repo-owner=os-santiago
community.github.repo-name=os-santiago.github.io
community.github.members-path=community/members.yaml
community.github.default-branch=main
# Verify Google ID tokens in production (Handled automatically by provider=google)
# removed redundant manual configuration

# Quest Board Configuration
quests.github.repo-owner=os-santiago
quests.github.repo-name=community-directory

# Application version
quarkus.application.version=3.6.2
# Store Vert.x cache on a writable volume
quarkus.vertx.cache-directory=${homedir.data.dir:./data}/vertx-cache
# Store HTTP file uploads on a writable volume
quarkus.http.body.uploads-directory=${homedir.data.dir:./data}/uploads
# Logging configuration
# Reduce log volume to avoid WRITE_FAILURE warnings
quarkus.log.category."io.quarkus.oidc".level=INFO
%dev.quarkus.log.category."io.quarkus.oidc".level=DEBUG
quarkus.log.category."io.vertx".level=INFO
# Ensure console logging is configured immediately
quarkus.log.console.enable=true
# JSON serialization settings
quarkus.jackson.fail-on-unknown-properties=true
quarkus.jackson.serialization-inclusion=non-null

quarkus.http.proxy.proxy-address-forwarding=true
quarkus.http.proxy.allow-forwarded=true
quarkus.http.auth.session.encryption-key=${SESSION_KEY}
quarkus.http.auth.permission.private.paths=/private/*
quarkus.http.auth.permission.private.policy=authenticated


# Controla el uso de la nueva UI (layout + templates v2).
# true  -> usa la nueva UI basada en layout/main + clases hd-*
# false -> fallback (si se implementa) a templates anteriores / minimal
homedir.ui.v2.enabled=true

# Local development authentication (disabled outside the dev profile)
%dev.quarkus.oidc.enabled=false
%test.quarkus.oidc.enabled=false
%dev.quarkus.security.users.embedded.enabled=true
%dev.quarkus.security.users.embedded.plain-text=true
%dev.quarkus.devservices.enabled=false
%dev.quarkus.security.users.embedded.users.user@example.com=userpass
%dev.quarkus.security.users.embedded.roles.user@example.com=user
%dev.quarkus.security.users.embedded.users.admin@example.org=adminpass
%dev.quarkus.security.users.embedded.roles.admin@example.org=admin,user
%dev.quarkus.http.auth.form.enabled=true
# %dev.quarkus.http.auth.form.login-page=/ingresar
# %dev.quarkus.http.auth.form.error-page=/ingresar?error=1
%dev.quarkus.http.auth.form.post-location=/j_security_check
%dev.quarkus.http.auth.form.username-parameter=username
%dev.quarkus.http.auth.form.password-parameter=password
%dev.quarkus.http.auth.form.landing-page=/profile
%dev.quarkus.http.auth.session.timeout=PT15M
%dev.ADMIN_LIST=admin@example.org,sergio.canales.e@gmail.com
%dev.app.auth.local-enabled=true
%dev.app.auth.local-users=usuario: user@example.com / userpass; admin: admin@example.org / adminpass

# Comma separated list of admin emails
ADMIN_LIST=sergio.canales.e@gmail.com

# Metrics flush interval (ISO-8601 duration, default PT10S)
# metrics.flush-interval=PT10S

# Snapshot read refresh configuration
read.window=PT2S
read.max-stale=PT10S

# Trend configuration
metrics.trend.min-baseline=20
metrics.trend.decimals=1

# Session expiration handling
app.auth.redirect-on-expire=true
app.auth.redirect-grace-ms=30000

quarkus.package.main-class=com.scanales.eventflow.VertxCacheFixMain

# Notifications runtime integration
quarkus.native.resources.includes=initial-quests.yaml
notifications.scheduler.enabled=true
notifications.scheduler.interval=PT15S
notifications.upcoming.window=PT5M
notifications.endingSoon.window=PT5M
notifications.ws.enabled=false
notifications.stream.maxConnectionsPerUser=1

# Iteration 6 defaults
notifications.metrics.enabled=true
notifications.logs.level=info
# provide a strong random secret (required in production)
notifications.user-hash.salt=${NOTIFICATIONS_USER_HASH_SALT:}
notifications.retention-days=30
notifications.max-file-size=3MB
notifications.maintenance.interval=PT30M
notifications.backpressure.queue.max=10000
notifications.backpressure.cutoff.evaluator-queue-depth=8000

# Rate limiting (per IP, fixed window)
rate.limit.enabled=true
rate.limit.window-seconds=60
rate.limit.auth.limit=30
rate.limit.logout.limit=30
rate.limit.api.limit=120

# Global notifications
notifications.global.enabled=true
notifications.simulation.enabled=true
notifications.simulation.allow-real=false
notifications.simulation.max-items=500

# Now box configuration
nowbox.enabled=true
nowbox.lookback=PT30M
nowbox.lookahead=PT60M
nowbox.refresh-interval=PT30S
