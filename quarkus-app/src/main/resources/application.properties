# Google OAuth configuration using OIDC automatic discovery
quarkus.oidc.provider=google
quarkus.oidc.application-type=web-app
quarkus.oidc.authentication.redirect-path=/ingresar
quarkus.oidc.client-id=${OIDC_CLIENT_ID}
quarkus.oidc.credentials.secret=${OIDC_CLIENT_SECRET}
quarkus.oidc.authentication.scopes=openid profile email
quarkus.oidc.logout.post-logout-path=/
# Disable Quarkus built-in logout as Google does not provide an
# end_session_endpoint. The application handles logout at /logout.
quarkus.oidc.logout.path=
quarkus.oidc.authentication.user-info-required=false
# Rely on the ID token for user attributes
quarkus.oidc.authentication.id-token-required=true
quarkus.oidc.token.principal-claim=id_token
# Verify Google ID tokens in production
%prod.mp.jwt.verify.issuer=https://accounts.google.com
%prod.smallrye.jwt.verify.key-location=https://www.googleapis.com/oauth2/v3/certs
%prod.mp.jwt.verify.audiences=${GOOGLE_CLIENT_ID}
%prod.smallrye.jwt.verify.algorithm=RS256
# Application version
quarkus.application.version=2.2.0
# Store Vert.x cache on a writable volume
quarkus.vertx.cache-directory=${eventflow.data.dir:./data}/vertx-cache
# Store HTTP file uploads on a writable volume
quarkus.http.body.uploads-directory=${eventflow.data.dir:./data}/uploads
# Logging configuration
# Reduce log volume to avoid WRITE_FAILURE warnings
quarkus.log.category."io.quarkus.oidc".level=INFO
%dev.quarkus.log.category."io.quarkus.oidc".level=DEBUG
quarkus.log.category."io.vertx".level=INFO
# Ensure console logging is configured immediately
quarkus.log.console.enable=true
# JSON serialization settings
quarkus.jackson.fail-on-unknown-properties=true
quarkus.jackson.serialization-inclusion=non-null

quarkus.http.proxy.proxy-address-forwarding=true
quarkus.http.proxy.allow-forwarded=true
quarkus.http.auth.session.encryption-key=${SESSION_KEY}
quarkus.http.auth.permission.ui.paths=/notifications/center
quarkus.http.auth.permission.ui.policy=authenticated
quarkus.http.auth.permission.api.paths=/api/notifications/*
quarkus.http.auth.permission.api.policy=authenticated
quarkus.http.auth.permission.private.paths=/private/*
quarkus.http.auth.permission.private.policy=authenticated

# Comma separated list of admin emails
ADMIN_LIST=sergio.canales.e@gmail.com

# Metrics flush interval (ISO-8601 duration, default PT10S)
# metrics.flush-interval=PT10S

# Snapshot read refresh configuration
read.window=PT2S
read.max-stale=PT10S

# Trend configuration
metrics.trend.min-baseline=20
metrics.trend.decimals=1

# Session expiration handling
app.auth.redirect-on-expire=true
app.auth.redirect-grace-ms=30000

quarkus.package.main-class=com.scanales.eventflow.VertxCacheFixMain

# Notifications runtime integration
notifications.scheduler.enabled=true
notifications.scheduler.interval=PT15S
notifications.upcoming.window=PT15M
notifications.endingSoon.window=PT10M
notifications.ws.enabled=true
notifications.stream.maxConnectionsPerUser=1

# Iteration 6 defaults
notifications.metrics.enabled=true
notifications.logs.level=info
# provide a random or secret value in production
notifications.user-hash.salt=changeme
notifications.retention-days=30
notifications.max-file-size=3MB
notifications.maintenance.interval=PT30M
notifications.backpressure.queue.max=10000
notifications.backpressure.cutoff.evaluator-queue-depth=8000
