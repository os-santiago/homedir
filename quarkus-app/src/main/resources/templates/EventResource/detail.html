{#include layout/base}
{#title}
{#if event}
{event.title}
{#else}
Evento
{/if}
{/title}
{#breadcrumbs}
{#if event}
<a href="/">Inicio</a><span class="sep">/</span><span>{event.title}</span>
{/if}
{/breadcrumbs}
{#main}
{#if event}
<section class="event-detail">
  <div class="card event-summary">
    <div class="event-header">
      {#if app:validUrl(event.logoUrl)}
      <img src="{event.logoUrl}" alt="Logo de {event.title}" class="event-logo">
      {/if}
      <div class="event-info">
        <h1 class="page-title">{event.title}</h1>
        <div class="event-tags">
          <span class="badge event-type {event.typeCss}">{event.typeLabel}</span>
          {#if event.isOngoing()}
          <span class="badge info">En curso</span>
          {/if}
        </div>
        {#if event.formattedDate}
        <p class="event-datetime">{event.formattedDate} | {event.startTimeStr} – {event.endTimeStr} hrs{#if
          event.timezone} ({event.timezone}){/if}.</p>
        {/if}
        {#if event.description}
        <p class="event-description">{event.description}</p>
        {/if}
        {#if app:validUrl(event.website) || app:validUrl(event.twitter) || app:validUrl(event.linkedin)
        || app:validUrl(event.instagram) || app:validEmail(event.contactEmail) || app:validUrl(event.ticketsUrl)}
        <div class="event-links">
          {#if app:validUrl(event.website)}<a href="{event.website}" target="_blank" rel="noopener" class="btn"><span
              class="material-symbols-outlined" style="font-size: 1.2em; vertical-align: middle;">language</span> Sitio
            Web</a>{/if}
          {#if app:validUrl(event.twitter)}<a href="{event.twitter}" target="_blank" rel="noopener" class="btn"><img
              src="https://cdn.simpleicons.org/twitter/white" width="16" height="16" alt="Twitter"
              style="vertical-align: middle;"> Twitter</a>{/if}
          {#if app:validUrl(event.linkedin)}<a href="{event.linkedin}" target="_blank" rel="noopener" class="btn"><img
              src="https://cdn.simpleicons.org/linkedin/white" width="16" height="16" alt="LinkedIn"
              style="vertical-align: middle;"> LinkedIn</a>{/if}
          {#if app:validUrl(event.instagram)}<a href="{event.instagram}" target="_blank" rel="noopener" class="btn"><img
              src="https://cdn.simpleicons.org/instagram/white" width="16" height="16" alt="Instagram"
              style="vertical-align: middle;"> Instagram</a>{/if}
          {#if app:validEmail(event.contactEmail)}<a href="mailto:{event.contactEmail}" target="_blank" rel="noopener"
            class="btn"><span class="material-symbols-outlined"
              style="font-size: 1.2em; vertical-align: middle;">email</span> Email</a>{/if}
          {#if app:validUrl(event.ticketsUrl)}<a href="{event.ticketsUrl}" target="_blank" rel="noopener"
            class="btn"><span class="material-symbols-outlined"
              style="font-size: 1.2em; vertical-align: middle;">confirmation_number</span> Entradas</a>{/if}
        </div>
        {/if}
      </div>
    </div>
    {#if app:validUrl(event.mapUrl)}
    <p><strong>Lugar:</strong> <a href="{event.mapUrl}" target="_blank" rel="noopener">Ver mapa</a></p>
    {/if}
    <p><strong>Duración:</strong> {event.days} día{#if event.days > 1}s{/if}</p>
    {#if !event.agenda.isEmpty()}
    <p><a href="#agenda" id="view-full-agenda" class="btn btn-secondary">Ver agenda completa</a></p>
    {/if}
  </div>
  {#if !event.scenarios.isEmpty()}
  <div class="card">
    <h2 class="card-title"><span class="icon"><span class="material-symbols-outlined">podium</span></span>Escenarios
    </h2>
    <div class="scenario-grid">
      {#for s in event.scenarios}
      <article class="scenario-card">
        <h3>{s.name}</h3>
        {#if s.location}<p class="scenario-location">{s.location}</p>{/if}
        <a href="/event/{event.id}/scenario/{s.id}" class="btn">Ver charlas</a>
      </article>
      {/for}
    </div>
  </div>
  {/if}
  {#if !event.agenda.isEmpty()}
  <div class="card agenda" id="agenda">
    <div class="view-toggle">
      <button id="agendaSeqBtn" data-agenda-seq-btn class="btn active" type="button">Secuencial</button>
      <button id="agendaGridBtn" data-agenda-grid-btn class="btn btn-secondary" type="button">Por escenario</button>
    </div>
    {#for d in event.dayList}
    <details class="agenda-day" open>
      <summary>Día {d}</summary>
      <div id="agenda-seq-{d}" class="agenda-view agenda-seq" data-agenda-seq>
        <table class="hd-table agenda-table">
          <colgroup>
            <col class="col-time">
            <col class="col-activity">
            <col class="col-speakers">
            <col class="col-scenario">
          </colgroup>
          <thead>
            <tr>
              <th class="hd-table-head">Horario</th>
              <th class="hd-table-head">Actividad</th>
              <th class="hd-table-head">Ponentes</th>
              <th class="hd-table-head">Escenario</th>
            </tr>
          </thead>
          <tbody>
            {#for t in event.getAgendaForDay(d)}
            <tr class="hd-table-row">
              <td class="agenda-time hd-table-cell">{t.startTimeStr} - {t.endTimeStr}</td>
              <td class="agenda-title hd-table-cell">
                <span class="icon">{#if t.break}<span class="material-symbols-outlined">coffee</span>{#else}<span
                    class="material-symbols-outlined">record_voice_over</span>{/if}</span>
                {#if t.break}
                <span class="agenda-title-text">{t.name}</span>
                {#else}
                <a href="/event/{event.id}/talk/{t.id}" class="agenda-title-text">{t.name}</a>
                {/if}
              </td>
              <td class="agenda-speakers hd-table-cell">
                {#if !t.break && !t.speakers.isEmpty()}
                <span class="speaker-avatars">
                  {#for s in t.speakers}
                  <a href="/speaker/{s.id}" title="{s.name}">
                    {#if app:validUrl(s.photoUrl)}
                    <img src="{s.photoUrl}" alt="{s.name}" class="avatar">
                    {#else}
                    <span class="avatar placeholder"><span class="material-symbols-outlined">person</span></span>
                    {/if}
                  </a>
                  {/for}
                </span>
                {/if}
              </td>
              <td class="agenda-location hd-table-cell"><a
                  href="/event/{event.id}/scenario/{t.location}">{event.getScenarioName(t.location)}</a></td>
            </tr>
            {/for}
          </tbody>
        </table>
      </div>
      <div id="agenda-grid-{d}" class="agenda-view agenda-grid hidden" data-agenda-grid>
        <table class="hd-table agenda-grid-table">
          <thead>
            <tr>
              <th class="hd-table-head">Horario</th>
              {#for sc in event.scenarios}
              <th class="hd-table-head">{sc.name}</th>
              {/for}
            </tr>
          </thead>
          <tbody>
            {#for e in event.getAgendaGroupedByTimeSlot(d).entrySet()}
            <tr class="hd-table-row">
              <td class="agenda-time hd-table-cell">{e.key}</td>
              {#for sc in event.scenarios}
              <td class="hd-table-cell">
                {#for t in e.value}
                {#if t.location == sc.id}
                <div class="agenda-slot">
                  {#if t.break}
                  {t.name}
                  {#else}
                  <a href="/event/{event.id}/talk/{t.id}">{t.name}</a>
                  {#if !t.speakers.isEmpty()}
                  <div class="agenda-slot-speakers">
                    {#for s in t.speakers}
                    <a href="/speaker/{s.id}">{s.name}</a>{#if !s_isLast}, {/if}
                    {/for}
                  </div>
                  {/if}
                  {/if}
                </div>
                {/if}
                {/for}
              </td>
              {/for}
            </tr>
            {/for}
          </tbody>
        </table>
      </div>
    </details>
    {/for}
  </div>
  {/if}
  <a href="/" class="btn">Volver al inicio</a>
</section>
{#else}
<p class="no-events">Evento no encontrado.</p>
{/if}
{/main}
{/include}