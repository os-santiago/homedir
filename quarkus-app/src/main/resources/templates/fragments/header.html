<nav class="top-nav" aria-label="{i18n.header_aria_label}">
  <div class="logo">
    <a href="/" class="header-logo-link">
      <div class="logo-icon">
        <svg viewbox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M50 15 L85 45 L85 85 L15 85 L15 45 Z" fill="#ffffff" stroke="#ffffff" stroke-width="3" />
          <path d="M50 15 L85 45 L75 45 L50 25 L25 45 L15 45 Z" fill="#FFD700" stroke="#ffffff" stroke-width="2" />
          <rect x="42" y="60" width="16" height="25" fill="#2d3748" stroke="#ffffff" stroke-width="2" />
          <rect x="25" y="52" width="12" height="12" fill="#4a5568" stroke="#ffffff" stroke-width="2" />
          <rect x="63" y="52" width="12" height="12" fill="#4a5568" stroke="#ffffff" stroke-width="2" />
          <rect x="28" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="32" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="66" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="70" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="65" y="30" width="8" height="15" fill="#ffffff" stroke="#ffffff" stroke-width="2" />
          <rect x="66" y="27" width="6" height="3" fill="#FFD700" />
          <path d="M50 20 Q45 15 40 12" stroke="#FFD700" stroke-width="2" fill="none" opacity="0.6" />
          <path d="M50 20 Q55 15 60 12" stroke="#FFD700" stroke-width="2" fill="none" opacity="0.6" />
          <circle cx="50" cy="22" r="2" fill="#FFD700" />
        </svg>
      </div>
      <div class="logo-text header-logo-text">
        <span id="navPlatformName" class="header-platform-name">HomeDir</span>
        <span class="logo-subtitle header-logo-subtitle" id="navTagline">{i18n.platform_by}</span>
      </div>
    </a>
  </div>

  <div class="nav-actions">
    <a href="/" class="retro-nav-link {#if activePage == 'home'}is-active{/if}">{i18n.nav_home}</a>
    <a href="/comunidad" class="retro-nav-link {#if activePage == 'comunidad'}is-active{/if}">{i18n.nav_community}</a>
    <a href="/proyectos" class="retro-nav-link {#if activePage == 'proyectos'}is-active{/if}">{i18n.nav_projects}</a>
    <a href="/eventos" class="retro-nav-link {#if activePage == 'eventos'}is-active{/if}">{i18n.nav_events}</a>
    <a href="/quests" class="retro-nav-link {#if activePage == 'quests'}is-active{/if}">{i18n.nav_quests}</a>

    <a href="/notifications/center" class="nav-link notifications-bell" aria-label="{i18n.nav_notifications}"
      data-nav-link>
      <span class="icon-bell" aria-hidden="true"></span>
      <span class="sr-only">{i18n.nav_notifications}</span>
      <span id="notif-badge" class="badge hidden">0</span>
    </a>

    {#if userSession.loggedIn || userAuthenticated}
    <div class="user-menu-container user-menu-wrapper">
      <div class="user-menu-toggle">
        <a href="/private/profile" class="user-profile-link user-profile-link-styled">
          {#if userSession.avatarUrl}
          <img src="{userSession.avatarUrl}" alt="Avatar" class="avatar-circle header-avatar-circle">
          {#else}
          <div class="avatar-circle header-avatar-fallback">
            {#if userSession.displayName}
            {userSession.displayName.substring(0,1)}
            {#else}
            {userInitial}
            {/if}
          </div>
          {/if}
          <span class="user-name">
            {#if userSession.questClass}
            <span title="{userSession.questClass.displayName}">{userSession.questClass.emoji}</span>
            {/if}
            {userSession.displayName ?: userName}
          </span>
          <span class="nes-badge is-splited header-level-badge">
            <span class="is-dark">LV</span>
            <span class="is-warning">{userSession.level}</span>
          </span>
        </a>
        <button class="user-menu-btn user-menu-btn-styled"
          onclick="this.parentElement.nextElementSibling.classList.toggle('show')">
          <span class="dropdown-arrow">â–¼</span>
        </button>
      </div>

      <div class="dropdown-menu header-dropdown-menu">
        <div class="dropdown-header header-dropdown-header">
          <small class="text-signed-in">{i18n.nav_signed_in_as}</small><br>
          <strong>{userSession.email ?: userName}</strong>
          <div class="header-xp-stats">
            <div class="header-xp-values">
              <span>LVL {userSession.level}</span>
              <span>{userSession.currentXp} / {userSession.nextLevelXp} XP</span>
            </div>
            <div class="xp-bar-container header-xp-bar-bg">
              <div class="xp-bar-fill header-xp-bar-fill"
                style="--xp-percent: {(userSession.currentXp / userSession.nextLevelXp) * 100}%;">
              </div>
            </div>
          </div>
        </div>

        <a href="/private/profile" class="dropdown-item header-dropdown-item">
          ğŸ‘¤ {i18n.nav_my_profile}
        </a>

        {#if userSession.isAdmin}
        <a href="/private/admin" class="dropdown-item header-dropdown-item header-dropdown-item-admin">
          âš™ï¸ {i18n.nav_admin_panel}
        </a>
        {/if}

        {#if !userSession.githubLinked}
        <a href="/private/github/connect" class="dropdown-item header-dropdown-item header-dropdown-item-connect">
          ğŸ”— {i18n.nav_connect_github}
        </a>
        {#else}
        <div class="dropdown-item header-dropdown-item-github">
          <span class="header-github-login">GitHub: @{userSession.githubLogin}</span>
        </div>
        {/if}

        <div class="dropdown-divider header-dropdown-divider"></div>

        <a href="/logout" class="dropdown-item header-dropdown-item header-dropdown-item-admin">
          ğŸšª {i18n.nav_logout}
        </a>
      </div>
    </div>
    {#else}
    <a href="/private/profile" class="login-btn-nav">{i18n.nav_login}</a>
    {/if}
  </div>
</nav>
<div class="alpha-banner">
  <span class="alpha-badge">ALPHA v{appVersion}</span>
  Â· <a href="https://github.com/os-santiago/homedir" target="_blank"
    class="link-white-underline">{i18n.header_alpha_repo}</a>
  Â· <span class="text-opacity-80">{i18n.header_alpha_text}</span>
</div>
{#if system.degraded}
<div class="system-banner">
  âš ï¸ {system.message} - {i18n.header_system_degraded}
</div>
{/if}