<nav class="top-nav" aria-label="Navegacion principal">
  <div class="logo">
    <a href="/" style="text-decoration: none; display: flex; align-items: center; gap: 0.5rem; color: #ffffff;">
      <div class="logo-icon">
        <svg viewbox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M50 15 L85 45 L85 85 L15 85 L15 45 Z" fill="#ffffff" stroke="#ffffff" stroke-width="3" />
          <path d="M50 15 L85 45 L75 45 L50 25 L25 45 L15 45 Z" fill="#FFD700" stroke="#ffffff" stroke-width="2" />
          <rect x="42" y="60" width="16" height="25" fill="#2d3748" stroke="#ffffff" stroke-width="2" />
          <rect x="25" y="52" width="12" height="12" fill="#4a5568" stroke="#ffffff" stroke-width="2" />
          <rect x="63" y="52" width="12" height="12" fill="#4a5568" stroke="#ffffff" stroke-width="2" />
          <rect x="28" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="32" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="66" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="70" y="55" width="2" height="2" fill="#ffffff" />
          <rect x="65" y="30" width="8" height="15" fill="#ffffff" stroke="#ffffff" stroke-width="2" />
          <rect x="66" y="27" width="6" height="3" fill="#FFD700" />
          <path d="M50 20 Q45 15 40 12" stroke="#FFD700" stroke-width="2" fill="none" opacity="0.6" />
          <path d="M50 20 Q55 15 60 12" stroke="#FFD700" stroke-width="2" fill="none" opacity="0.6" />
          <circle cx="50" cy="22" r="2" fill="#FFD700" />
        </svg>
      </div>
      <div class="logo-text" style="font-weight: 800; letter-spacing: 1px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
        <span id="navPlatformName" style="font-size: 1.4rem;">HomeDir</span>
        <span class="logo-subtitle" id="navTagline" style="color: #ffd700; font-weight: 600;">by
          OpenSourceSantiago</span>
      </div>
    </a>
  </div>

  <div class="nav-actions">
    <a href="/" class="retro-nav-link {#if activePage == 'home'}is-active{/if}">Home</a>
    <a href="/comunidad" class="retro-nav-link {#if activePage == 'comunidad'}is-active{/if}">Comunidad</a>
    <a href="/proyectos" class="retro-nav-link {#if activePage == 'proyectos'}is-active{/if}">Proyectos</a>
    <a href="/eventos" class="retro-nav-link {#if activePage == 'eventos'}is-active{/if}">Eventos</a>
    <a href="/quests" class="retro-nav-link {#if activePage == 'quests'}is-active{/if}">Quests</a>

    <a href="/notifications/center" class="nav-link notifications-bell" aria-label="Notificaciones" data-nav-link>
      <span class="icon-bell" aria-hidden="true"></span>
      <span class="sr-only">Notificaciones</span>
      <span id="notif-badge" class="badge hidden">0</span>
    </a>

    {#if userSession.loggedIn || userAuthenticated}
    <div class="user-menu-container" style="position: relative; margin-left: 1rem;">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <a href="/private/profile" class="user-profile-link"
          style="text-decoration: none; color: white; display: flex; align-items: center; gap: 0.5rem; font-family: var(--font-display);">
          {#if userSession.avatarUrl}
          <img src="{userSession.avatarUrl}" alt="Avatar" class="avatar-circle"
            style="width: 32px; height: 32px; border-radius: 50%; border: 2px solid var(--accent-color);">
          {#else}
          <div class="avatar-circle"
            style="width: 32px; height: 32px; background: var(--accent-color); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white;">
            {#if userSession.displayName}
            {userSession.displayName.substring(0,1)}
            {#else}
            {userInitial}
            {/if}
          </div>
          {/if}
          <span class="user-name">
            {#if userSession.questClass}
            <span title="{userSession.questClass.displayName}">{userSession.questClass.emoji}</span>
            {/if}
            {userSession.displayName ?: userName}
          </span>
          <span class="nes-badge is-splited" style="margin-left: 0.5rem; transform: scale(0.8);">
            <span class="is-dark">LV</span>
            <span class="is-warning">{userSession.level}</span>
          </span>
        </a>
        <button class="user-menu-btn" onclick="this.parentElement.nextElementSibling.classList.toggle('show')"
          style="background: transparent; border: none; color: white; cursor: pointer; padding: 0.25rem;">
          <span class="dropdown-arrow">‚ñº</span>
        </button>
      </div>

      <div class="dropdown-menu"
        style="display: none; position: absolute; top: 100%; right: 0; background: rgba(0,0,0,0.9); border: 1px solid var(--accent-color); border-radius: 4px; padding: 0.5rem; min-width: 200px; z-index: 1000; box-shadow: 0 4px 10px rgba(0,0,0,0.5);">
        <div class="dropdown-header"
          style="border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 0.5rem; margin-bottom: 0.5rem;">
          <small style="color: #888;">Signed in as</small><br>
          <strong>{userSession.email ?: userName}</strong>
          <div style="margin-top: 0.5rem;">
            <div style="display: flex; justify-content: space-between; font-size: 0.7rem; color: #ffd700;">
              <span>LVL {userSession.level}</span>
              <span>{userSession.currentXp} / {userSession.nextLevelXp} XP</span>
            </div>
            <div class="xp-bar-container"
              style="width: 100%; height: 6px; background: #333; border-radius: 3px; overflow: hidden; margin-top: 2px;">
              <div class="xp-bar-fill"
                style="width: {(userSession.currentXp / userSession.nextLevelXp) * 100}%; height: 100%; background: linear-gradient(90deg, #ffd700, #ff80a0); transition: width 0.5s ease;">
              </div>
            </div>
          </div>
        </div>

        <a href="/private/profile" class="dropdown-item"
          style="display: block; color: white; padding: 0.5rem; text-decoration: none; transition: background 0.2s;">
          üë§ Mi Perfil
        </a>

        {#if userSession.isAdmin}
        <a href="/private/admin" class="dropdown-item"
          style="display: block; color: #ff80a0; padding: 0.5rem; text-decoration: none; transition: background 0.2s;">
          ‚öôÔ∏è Panel Administraci√≥n
        </a>
        {/if}

        {#if !userSession.githubLinked}
        <a href="/private/github/connect" class="dropdown-item"
          style="display: block; color: #ffd700; padding: 0.5rem; text-decoration: none; transition: background 0.2s;">
          üîó Conectar GitHub
        </a>
        {#else}
        <div class="dropdown-item" style="padding: 0.5rem; color: #8affc1;">
          <span style="font-size: 0.8rem;">GitHub: @{userSession.githubLogin}</span>
        </div>
        {/if}

        <div class="dropdown-divider" style="height: 1px; background: rgba(255,255,255,0.1); margin: 0.5rem 0;"></div>

        <a href="/logout" class="dropdown-item"
          style="display: block; color: #ff80a0; padding: 0.5rem; text-decoration: none; transition: background 0.2s;">
          üö™ Cerrar Sesi√≥n
        </a>
      </div>
    </div>
    {#else}
    <a href="/private/profile" class="login-btn-nav">Login</a>
    {/if}
  </div>
</nav>
<div class="alpha-banner"
  style="background: linear-gradient(90deg, #ff00cc, #333399); color: white; text-align: center; padding: 0.2rem; font-size: 0.8rem; font-family: var(--font-mono); border-bottom: 1px solid rgba(255,255,255,0.2);">
  <span style="background: rgba(0,0,0,0.3); padding: 0 0.5rem; border-radius: 4px;">ALPHA v3.1.1</span>
  ¬∑ <a href="https://github.com/os-santiago/homedir" target="_blank"
    style="color: white; text-decoration: underline;">GitHub Repo</a>
  ¬∑ <span style="opacity: 0.8;">DevRel, OpenSource, InnerSource Community Platform</span>
</div>