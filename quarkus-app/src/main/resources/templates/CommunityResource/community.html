{#include layout/main activePage="comunidad"}
{#title}Comunidad Â· Homedir{/title}
{#body}
<main id="main-content" class="homedir-main" role="main">



  <header class="page-header events-page-header">
    <div class="section-header">
      <p class="section-subtitle">Personas Â· Comunidad</p>
      <h1>Construimos Homedir juntos</h1>
    </div>
    <p class="section-subtitle">Explora el directorio de integrantes, conecta con la comunidad y Ãºnete usando tu
      cuenta
      vinculada de GitHub.</p>

    <div class="main-sections">
      <div class="section-card">
        <p class="eyebrow">Integrantes</p>
        <h2>{totalMembers}</h2>
        <p>Activos en la comunidad</p>
      </div>
      <div class="section-card">
        <p class="eyebrow">Visibilidad</p>
        <h2>GitHub</h2>
        <p>Se muestra tu usuario</p>
      </div>
      <div class="section-card">
        <p class="eyebrow">Acceso</p>
        <h2>Roles</h2>
        <p>Colaborador Â· Administrador</p>
      </div>
    </div>

    <section class="leaderboard-section community-leaderboard-section">
      <h2 class="section-subtitle">Top Heroes</h2>
      <div class="leaderboard-grid community-leaderboard-grid">
        {#for hero in leaderboard}
        <div class="hd-card-surface community-hero-card">
          <div class="community-hero-rank">#{hero_count}</div>
          <div>
            <h3 class="community-hero-name">{hero.name}</h3>
            <p class="community-hero-stats">Nivel {hero.level} Â· {hero.xp} XP</p>
          </div>
        </div>
        {/for}
      </div>
    </section>

    <div class="header-actions">
      {#if userSession.communityMember}
      <div class="user-badge community-user-badge">
        <span class="community-user-icon">âœ¨</span>
        <span>Â¡Ya eres parte de la comunidad!</span>
      </div>
      <div class="community-actions-row">
        <a class="btn-primary btn-transparent" href="#directorio">Ver directorio</a>
        <a class="btn-primary btn-outline-dim"
          href="https://github.com/os-santiago/os-santiago.github.io/blob/main/community/members.yaml" target="_blank">
          Ver members.yaml
        </a>
      </div>

      {#else}
      {#if !userSession.loggedIn}
      <div class="btn-align-start">
        <a href="/private/profile" class="btn-primary">Inicia SesiÃ³n para unirte</a>
      </div>
      {#else if !userSession.githubLinked}
      <form action="/private/github/start" method="GET" class="btn-align-start">
        <input type="hidden" name="redirect" value="/comunidad" />
        <button type="submit" class="btn-primary btn-github-dark">
          <svg height="20" viewBox="0 0 16 16" version="1.1" width="20" aria-hidden="true" class="icon-github">
            <path fill-rule="evenodd"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
            </path>
          </svg>
          Conectar GitHub para unirte
        </button>
      </form>
      {#else}
      {#if joined}
      <div class="btn-align-start">
        <button disabled class="btn-primary btn-disabled">Solicitud en proceso...</button>
        <p class="text-status-msg">
          Tu solicitud ha sido enviada. Revisa tus <a href="{prUrl}" target="_blank" class="link-underline-white">Pull
            Requests</a>.
        </p>
      </div>
      {#else}
      <form action="/comunidad/unirse" method="POST" class="btn-align-start">
        <input type="hidden" name="redirect" value="/comunidad" />
        <button type="submit" class="btn-primary">Unirme a la comunidad</button>
      </form>
      {/if}
      {/if}
      {#if !userSession.communityMember}
      <div class="btn-align-start">
        <a class="btn-primary btn-transparent" href="#directorio">Ver directorio</a>
      </div>
      {/if}
      {/if}
    </div>
  </header>

  <section class="page-grid">
    <div class="section-header events-section-margin" style="grid-column: 1 / -1;" id="directorio">
      <div class="community-directory-header">
        <div>
          <p class="section-subtitle">Directorio</p>
          <h2 class="page-title">Personas de la comunidad</h2>
        </div>
        <form class="search-form community-search-form" method="get" action="/comunidad">
          <input type="search" name="q" value="{query}" placeholder="Buscar por nombre, GitHub o habilidades"
            aria-label="Buscar integrante" class="community-search-input">
          <button class="btn-primary btn-search-submit" type="submit">Buscar</button>
        </form>
      </div>
    </div>

    {#if filtered.size == 0}
    <div class="section-card" style="grid-column: 1 / -1;">
      <p>AÃºn no hay integrantes visibles con este filtro.</p>
    </div>
    {#else}
    {#for member in filtered}
    <a href="{member.profileUrl}" target="_blank" class="section-card community-member-card">
      <div class="member-card-content">
        {#if member.avatarUrl}
        <img src="{member.avatarUrl}" alt="{member.name}" class="member-avatar">
        {#else}
        <div class="member-avatar-placeholder">
          <span class="community-user-icon">ðŸ‘¤</span>
        </div>
        {/if}
        <div>
          <h3 class="member-name">{member.name}</h3>
          {#if member.role}
          <span class="member-role-badge">{member.role}</span>
          {/if}
          <span class="member-level-badge">Lvl {member.level}</span>
          {#if member.skills && member.skills.size > 0}
          <div class="member-skills-container">
            {#for skill in member.skills}
            <span class="member-skill-badge">{skill}</span>
            {/for}
          </div>
          {/if}
        </div>
      </div>
      {#if member.github}
      <div class="member-github-link">
        <svg height="16" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true" class="icon-fill-current">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
        @{member.github}
      </div>
      {/if}
    </a>
    {/for}
    {/if}
</main>
{/body}